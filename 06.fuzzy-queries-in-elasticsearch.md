# Practical Guide for Fuzzy Queries in Elasticsearch

## Prerequisites
1. **Elasticsearch**:
   - Ensure the service is running and accessible at `http://localhost:9200`.
2. **Kibana**:
   - Use Kibana Dev Tools to run queries.
<img width="816" alt="image" src="https://github.com/user-attachments/assets/b9195c49-2fac-4207-88eb-81469070e610">


---

## Understanding Fuzzy Queries
A **fuzzy query** matches documents where the value of a specific field is similar to the query string. It is useful for:
- Handling typos
- Allowing approximate matches
- Searching with slight misspellings

### Key Parameters
- **fuzziness**: Maximum edit distance (0, 1, 2). 
- **prefix_length**: Number of initial characters that should not be "fuzzed."
- **max_expansions**: Limits the number of terms generated by the query.

---

## Step 1: Create an Index
Create a sample index (e.g., `fuzzy_demo`) with sample documents.

```json
PUT /fuzzy_demo
{
  "mappings": {
    "properties": {
      "name": {
        "type": "text"
      },
      "description": {
        "type": "text"
      }
    }
  }
}
```

---

## Step 2: Insert Documents
Add some documents with slight variations in field values.

```json
POST /fuzzy_demo/_doc/1
{
  "name": "Elasticsearch",
  "description": "Search and analytics engine"
}
POST /fuzzy_demo/_doc/2
{
  "name": "Elastic Search",
  "description": "Distributed search platform"
}
POST /fuzzy_demo/_doc/3
{
  "name": "ElasticSearch",
  "description": "Data visualization tool"
}
POST /fuzzy_demo/_doc/4
{
  "name": "Search Engine",
  "description": "Elastic's main service"
}

```
---

## Step 3: Perform a Fuzzy Query
Now, use a **fuzzy query** to find documents even with typos or minor variations in the search term.

### Query
Find documents where the `name` field is similar to "Elastiksearch" (intentionally misspelled).

```json
GET /fuzzy_demo/_search
{
  "query": {
    "fuzzy": {
      "name": {
        "value": "Elastiksearch",
        "fuzziness": "AUTO", 
        "prefix_length": 3,
        "max_expansions": 10
      }
    }
  }
}
```

### Explanation
- value: The search term.
- fuzziness: AUTO automatically determines the appropriate fuzziness (based on word length). You can also set it to 1 or 2.
- prefix_length: The first 3 characters must match exactly.
- max_expansions: Limits the number of terms that can be generated for the query.

## Step 4: Analyze Results
The response will include documents with names similar to "Elastiksearch."

### Sample Response
```json
{
  "hits": {
    "total": 3,
    "hits": [
      { "_source": { "name": "ElasticSearch", "description": "Data visualization tool" } },
      { "_source": { "name": "Elasticsearch", "description": "Search and analytics engine" } },
      { "_source": { "name": "Elastic Search", "description": "Distributed search platform" } }
    ]
  }
}
```

## Step 5: Experiment with Fuzziness
1. Change the fuzziness parameter:
- Try fuzziness: 1 (1 edit distance) and observe how the results differ.
2. Adjust the prefix_length:
- Increase or decrease the number of non-fuzzy characters to see its impact.
3. Search in another field:
- Use description or another text field.
### Example Query
Search for documents where the description field is similar to "search enjin" with 2 edit distances.

```json
GET /fuzzy_demo/_search
{
  "query": {
    "fuzzy": {
      "description": {
        "value": "search enjin",
        "fuzziness": 2
      }
    }
  }
}
```

## Step 6: Combine with Other Queries
Combine the fuzzy query with other queries like match or term using the bool query for more complex searches.

### Example Query
Search for documents with a fuzzy match on the name field and a specific term in the description field.

```json
GET /fuzzy_demo/_search
{
  "query": {
    "bool": {
      "must": [
        { "fuzzy": { "name": { "value": "elastiksearch", "fuzziness": "AUTO" } } },
        { "match": { "description": "engine" } }
      ]
    }
  }
}
```

## Step 7: Clean Up
If you no longer need the index, delete it to free up resources.

```json
DELETE /fuzzy_demo
```
